javascript:(function()%7Bconst%20appElement%20%3D%20document.querySelector('%5Bng-app%5D%2C%20%5Bdata-ng-app%5D')%0A%20%20const%20injector%20%3D%20window.angular.element(appElement).injector()%0A%20%20const%20%24rootScope%20%3D%20injector.get('%24rootScope')%0A%0A%0A%20%20function%20findScope%20(scope%2C%20controllerName)%20%7B%0A%20%20%20%20if%20(scope.renderers)%20%7B%0A%20%20%20%20%20%20return%20scope%0A%20%20%20%20%7D%0A%20%20%20%20if%20(scope.%24%24childHead)%20%7B%0A%20%20%20%20%20%20return%20findScope(scope.%24%24childHead%2C%20controllerName)%0A%20%20%20%20%7D%0A%20%20%20%20if%20(scope.%24%24nextSibling)%20%7B%0A%20%20%20%20%20%20return%20findScope(scope.%24%24nextSibling%2C%20controllerName)%0A%20%20%20%20%7D%0A%20%20%20%20return%20null%0A%20%20%7D%0A%0A%20%20function%20annotateRuby%20(japaneseTextRaw%2C%20hiraganaTextRaw)%20%7B%0A%20%20%20%20const%20rubyTextGroups%20%3D%20%5B%5D%0A%20%20%20%20const%20japaneseTextGroups%20%3D%20japaneseTextRaw.trim().split('%20')%0A%20%20%20%20const%20hiraganaTextGroups%20%3D%20hiraganaTextRaw.trim().split('%20')%0A%0A%20%20%20%20for%20(let%20j%20%3D%200%3B%20j%20%3C%20japaneseTextGroups.length%3B%20j%2B%2B)%20%7B%0A%20%20%20%20%20%20const%20japaneseText%20%3D%20japaneseTextGroups%5Bj%5D%0A%20%20%20%20%20%20const%20hiraganaText%20%3D%20hiraganaTextGroups%5Bj%5D%0A%20%20%20%20%20%20let%20hiraganaIndex%20%3D%200%0A%20%20%20%20%20%20let%20i%20%3D%200%0A%20%20%20%20%20%20let%20rubyTextFrag%20%3D%20''%0A%20%20%20%20%20%20while%20(i%20%3C%20japaneseText.length)%20%7B%0A%20%20%20%20%20%20%20%20const%20char%20%3D%20japaneseText%5Bi%5D%0A%0A%20%20%20%20%20%20%20%20if%20(%2F%5B%5Cu4E00-%5Cu9FAF%5D%2F.test(char))%20%7B%0A%20%20%20%20%20%20%20%20%20%20let%20kanjiEnd%20%3D%20i%20%2B%201%0A%0A%20%20%20%20%20%20%20%20%20%20while%20(kanjiEnd%20%3C%20japaneseText.length%20%26%26%20%2F%5B%5Cu4E00-%5Cu9FAF%5D%2F.test(japaneseText%5BkanjiEnd%5D))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20kanjiEnd%2B%2B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20const%20kanji%20%3D%20japaneseText.slice(i%2C%20kanjiEnd)%0A%0A%20%20%20%20%20%20%20%20%20%20const%20hiraganaEnd%20%3D%20japaneseText.length%20-%20kanjiEnd%0A%20%20%20%20%20%20%20%20%20%20const%20furigana%20%3D%20hiraganaText.slice(hiraganaIndex%2C%20hiraganaEnd%20%3F%20-hiraganaEnd%20%3A%20undefined)%0A%0A%20%20%20%20%20%20%20%20%20%20rubyTextFrag%20%2B%3D%20%60%3Cruby%3E%24%7Bkanji%7D%3Crt%3E%24%7Bfurigana%7D%3C%2Frt%3E%3C%2Fruby%3E%60%0A%20%20%20%20%20%20%20%20%20%20i%20%3D%20kanjiEnd%0A%20%20%20%20%20%20%20%20%20%20hiraganaIndex%20%3D%20hiraganaEnd%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20rubyTextFrag%20%2B%3D%20char%0A%20%20%20%20%20%20%20%20%20%20i%2B%2B%0A%20%20%20%20%20%20%20%20%20%20hiraganaIndex%2B%2B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20rubyTextGroups.push(rubyTextFrag)%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20rubyText%20%3D%20rubyTextGroups.join('%20')%0A%20%20%20%20console.log(rubyText)%0A%20%20%20%20return%20rubyText%0A%20%20%7D%0A%0A%20%20const%20rubyCtx%20%3D%20%7B%7D%0A%0A%20%20function%20maybeAnnotateRuby%20(dialogue%2C%20renderer)%20%7B%0A%20%20%20%20rubyCtx%5Brenderer.subtitleLanguage%5D%20%3D%20%7B%0A%20%20%20%20%20%20dialogue%2C%0A%20%20%20%20%20%20renderer%0A%20%20%20%20%7D%0A%20%20%20%20const%20otherCtx%20%3D%20Object.keys(rubyCtx).filter(x%20%3D%3E%20x%20!%3D%3D%20renderer.subtitleLanguage)%0A%20%20%20%20if%20(!otherCtx.length)%20%7B%0A%20%20%20%20%20%20return%0A%20%20%20%20%7D%0A%20%20%20%20if%20(!otherCtx.every(x%20%3D%3E%20rubyCtx%5Bx%5D.dialogue.start%20%3D%3D%3D%20dialogue.start))%20%7B%0A%20%20%20%20%20%20return%0A%20%20%20%20%7D%0A%20%20%20%20const%20hiraganaElement%20%3D%20document.querySelector('.layerhiragana%20.hiragana.subtitle')%0A%20%20%20%20hiraganaElement.style.display%20%3D%20'none'%0A%20%20%20%20const%20japaneseElement%20%3D%20document.querySelector('.anjapanese%20.japanese.subtitle')%0A%20%20%20%20const%20rubyText%20%3D%20annotateRuby(rubyCtx.japanese.dialogue._rawPartsString%2C%20rubyCtx.hiragana.dialogue._rawPartsString)%0A%20%20%20%20japaneseElement.innerHTML%20%3D%20rubyText%0A%20%20%7D%0A%0A%20%20const%20%24scope%20%3D%20findScope(%24rootScope%2C%20'videoCtrl')%0A%0A%20%20if%20(!%24scope)%20%7B%0A%20%20%20%20console.error('Could%20not%20find%20the%20scope%20for%20controller')%0A%20%20%20%20return%0A%20%20%7D%0A%0A%20%20const%20japaneseRenderer%20%3D%20%24scope.renderers.find(x%20%3D%3E%20x.language%20%3D%3D%3D%20'japanese')%0A%20%20const%20hiraganaRenderer%20%3D%20%24scope.renderers.find(x%20%3D%3E%20x.language%20%3D%3D%3D%20'hiragana')%0A%0A%20%20if%20(window.origJpRenderDraw)%20%7B%0A%20%20%20%20japaneseRenderer.renderer.draw%20%3D%20window.origJpRenderDraw%0A%20%20%7D%0A%20%20if%20(window.origHiRenderDraw)%20%7B%0A%20%20%20%20hiraganaRenderer.renderer.draw%20%3D%20window.origHiRenderDraw%0A%20%20%7D%0A%20%20window.origJpRenderDraw%20%3D%20japaneseRenderer.renderer.draw%0A%20%20window.origHiRenderDraw%20%3D%20hiraganaRenderer.renderer.draw%0A%0A%20%20japaneseRenderer.renderer.draw%20%3D%20(dialogue)%20%3D%3E%20%7B%0A%20%20%20%20window.origJpRenderDraw.apply(japaneseRenderer.renderer%2C%20%5Bdialogue%5D)%0A%20%20%20%20maybeAnnotateRuby(dialogue%2C%20japaneseRenderer.renderer)%0A%20%20%7D%0A%0A%20%20hiraganaRenderer.renderer.draw%20%3D%20(dialogue)%20%3D%3E%20%7B%0A%20%20%20%20window.origHiRenderDraw.apply(hiraganaRenderer.renderer%2C%20%5Bdialogue%5D)%0A%20%20%20%20maybeAnnotateRuby(dialogue%2C%20hiraganaRenderer.renderer)%0A%20%20%7D%7D)()%3B